module.exports.config = {
    name: 'autosent',
    version: '10.04',
    hasPermssion: 2,
    credits: 'MrTomXxX | edited savage version',
    description: '24 ghonta auto msg pathabe + funny Bangla',
    commandCategory: 'Group',
    usages: 'autosent on | autosent off | autosent status',
    cooldowns: 5
};

const messages = [
    { hour: 0,  message: ["рж░рж╛ржд рззрзиржЯрж╛ ржмрж╛ржЬрзЗ... ржПржЦржирзЛ ржЬрзЗржЧрзЗ ржЖржЫрж┐рж╕? ржХрж┐ ржЖржХрж╛ржо ржХрж░ржЫрж┐рж╕ рж╢рзБржирж┐ ЁЯШ╖"] },
    { hour: 1,  message: ["рззржЯрж╛ ржмрж╛ржЬрзЗ... ржпрж╛рж░рж╛ ржПржЦржирзЛ ржЕржирж▓рж╛ржЗржи, рждрж╛ржжрзЗрж░ ржШрзБржо рж╣рж╛рж░рж╛ржо рж╣рзЯрзЗ ржЧрзЗржЫрзЗ ржирж╛ржХрж┐? ЁЯШн"] },
    { hour: 2,  message: ["рзиржЯрж╛... ржПржЦржирзЛ ржирж╛ ржШрзБржорж╛рж▓рзЗ ржХрж╛рж▓ржХрзЗ ржжрзЗржЦрждрзЗ zombie рж▓рж╛ржЧржмрзЗ ржнрж╛ржЗ, trust me ЁЯШ┤"] },
    { hour: 3,  message: ["рзйржЯрж╛ ржмрж╛ржЬрзЗ... ржпрзЗ ржПржЦржирзЛ ржЪрзНржпрж╛ржЯ ржХрж░ржЫрзЗ рж╕рзЗ single ржирж╛ married? ржЙрждрзНрждрж░ ржжрзЗ ржирж╛ ржжрж┐рж▓рзЗ ржзрж░рзЗ ржирзЗржм single ЁЯШВ"] },
    { hour: 4,  message: ["рзкржЯрж╛... ржПржЦржи ржШрзБржо ржирж╛ ржЧрзЗрж▓рзЗ рж╕ржХрж╛рж▓рзЗ ржорзБржЦ ржжрзЗржЦрж▓рзЗ ржЖрзЯржирж╛ ржнрзЗржЩрзЗ ржпрж╛ржмрзЗ ржмрж╛ржкрзЗрж░ ЁЯШн"] },
    { hour: 5,  message: ["рзлржЯрж╛... ржлржЬрж░рзЗрж░ ржЖржпрж╛ржи рж╢рзБржиржЫрж┐рж╕? ржирж╛ рж╢рзБржзрзБ game ржПрж░ notification? ржирж╛ржорж╛ржЬ ржкрзЬ ржирж╛ рж╣рж▓рзЗ like ржжрзЗ ЁЯд▓"] },
    { hour: 6,  message: ["рж╕ржХрж╛рж▓ рзмржЯрж╛ тАФ good morning ржирж╛ ржмрж▓рзЗ ржмрж▓рж┐... ржЙржа ржХрзБрждрзНрждрж╛! тШАя╕ПЁЯР╢"] },
    { hour: 7,  message: ["рзнржЯрж╛... ржпрж╛рж░рж╛ ржПржЦржирзЛ ржмрж┐ржЫрж╛ржирж╛рзЯ, рждрж╛ржжрзЗрж░ ржорж╛ ржПржЦржи рж▓рж╛ржерж┐ ржорж╛рж░рж╛рж░ ржкрзНрж▓рзНржпрж╛ржи ржХрж░ржЫрзЗ ЁЯдг"] },
    { hour: 8,  message: ["рзоржЯрж╛ ржмрж╛ржЬрзЗ... office/school ржпрж╛ржмрж┐ ржирж╛? ржирж╛ ржХрж┐ ржЖржЬржХрзЗржУ "ржЕрж╕рзБрж╕рзНрже" ржорж╛рж░ржмрж┐? ЁЯдТ"] },
    { hour: 9,  message: ["рзпржЯрж╛... ржпрзЗ ржПржЦржирзЛ ржШрзБржорж╛ржЪрзНржЫрзЗ рж╕рзЗ рж░рж╛ржЬрж╛ ржирж╛ рж╣рж▓рзЗ ржХрж┐? рж░рж╛ржЬрж╛рж░ ржоржд ржШрзБржо ЁЯШ┤ЁЯСС"] },
    { hour: 10, message: ["рззрзжржЯрж╛... ржирж╛рж╢рждрж╛ ржЦрзЗрзЯрзЗржЫрж┐рж╕? ржирж╛ рж╢рзБржзрзБ like ржЖрж░ comment ржПрж░ diet ржЪрж▓ржЫрзЗ? ЁЯН│"] },
    { hour: 11, message: ["рззрззржЯрж╛... ржПржЦржирзЛ ржХрж╛ржЬ рж╢рзБрж░рзБ ржХрж░рж┐рж╕ржирж┐? ржмрж╕ рждрзЛржХрзЗ ржжрзЗржЦрж▓рзЗ ржмрж▓ржмрзЗ,tui toh ржкрзЛрж╕рзНржЯрж╛рж░ ржмрзЯ ржЕржл procrastination ЁЯШВ"] },
    { hour: 12, message: ["ржжрзБржкрзБрж░ рззрзиржЯрж╛ тАФ ржнрж╛ржд ржЦрж╛... ржирж╛ ржЦрзЗрж▓рзЗ рж░рж╛рждрзЗ ржнрзВржд рж╣рзЯрзЗ ржЖржорж╛рж░рзЗ ржЯрзЗржХрзНрж╕ржЯ ржХрж░ржмрж┐ ржирж╛ ржХрж┐ржирзНрждрзБ ЁЯС╗"] },
    { hour: 13, message: ["рззржЯрж╛... ржпрж╛рж░рж╛ рж▓рж╛ржЮрзНржЪ рж╕рзНржХрж┐ржк ржХрж░ржЫрзЗ, ржХрж╛рж▓ржХрзЗ ржкрзЗржЯрзЗ ржЧрзНржпрж╛рж╕ рж╣рзЯрзЗ ржЪрж┐рзОржХрж╛рж░ ржХрж░ржмрзЗ тЪб"] },
    { hour: 14, message: ["рзиржЯрж╛... ржжрзБржкрзБрж░рзЗрж░ ржШрзБржо ржжрж┐ржмрж┐? ржжрзЗ... рждржмрзЗ рзл ржорж┐ржирж┐ржЯ ржкрж░ ржЙржарзЗ ,ржЖрж░рзЗржХржЯрзБ, ржмрж▓ржмрж┐ ржирж╛ ЁЯШд"] },
    { hour: 15, message: ["рзйржЯрж╛... ржЧрж░ржорзЗ ржЧрж▓ржЫрж┐рж╕? ржлрзНрж░рж┐ржЬрзЗрж░ ржжрж░ржЬрж╛ ржЦрзБрж▓рзЗ ржмрж╕рзЗ ржерж╛ржХ ржмрж╕ ЁЯдг"] },
    { hour: 16, message: ["рзкржЯрж╛... ржЖржЬрж╛ржи рж╣ржмрзЗ ржПржХржЯрзБ ржкрж░... ржирж╛ржорж╛ржЬ ржкрзЬрзЗ ржЖрзЯ, ржЧрзБржирж╛рж╣рзЗрж░ рж▓рж┐рж╕рзНржЯ рж▓ржорзНржмрж╛ рж╣рзЯрзЗ ржЧрзЗржЫрзЗ рждрзЛрж░ ЁЯШЮ"] },
    { hour: 17, message: ["рзлржЯрж╛... ржЪрж╛ ржЦрж╛ржмрж┐? ржирж╛ ржХрж┐ рж╢рзБржзрзБ online ржЖржЫрж┐ ржжрзЗржЦрж╛ржмрж┐? тШХ"] },
    { hour: 18, message: ["рж╕ржирзНржзрзНржпрж╛ рзмржЯрж╛ тАФ good evening ржирж╛... ржЖржЬржХрзЗржУ ржмрзЗржХрж╛рж░рждрзНржмрзЗрж░ рж░рзЗржХрж░рзНржб ржнрж╛ржЩрж▓рж┐? ЁЯМЖ"] },
    { hour: 19, message: ["рзнржЯрж╛... ржорж╛ржЧрж░рж┐ржмрзЗрж░ ржирж╛ржорж╛ржЬ ржкрзЬрзЗржЫрж┐рж╕? ржирж╛ ржХрж┐ рж░рж┐рж▓ ржжрзЗржЦрждрзЗ ржжрзЗржЦрждрзЗ ржоржирзЗ ржкрзЬрж▓? ЁЯХМ"] },
    { hour: 20, message: ["рзоржЯрж╛... ржбрж┐ржирж╛рж░ ржХрж░... ржирж╛ рж╣рж▓рзЗ рж░рж╛ржд рзиржЯрж╛рзЯ ржХрзНрж╖рзБржзрж╛рж░рзНржд ржХрзБрждрзНрждрж╛ рж╣ржпрж╝рзЗ ржпрж╛ржмрж┐ЁЯР╢"] },
    { hour: 21, message: ["рзпржЯрж╛... ржПржЦржирзЛ ржлрзЛржирзЗ? ржЪрзЛржЦ ржжрзБржЗржЯрж╛ ржбрж╛рзЯржоржирзНржб рж╣рзЯрзЗ ржЧрзЗржЫрзЗ ржжрзЗржЦрж┐? ЁЯТО"] },
    { hour: 22, message: ["рззрзжржЯрж╛... ржпрж╛рж░рж╛ ржПржЦржирзЛ ржЬрзЗржЧрзЗ ржЖржЫрзЗ рждрж╛ржжрзЗрж░ tomorrow ржХрзЗ ржмрж▓ тАФ sorry boss late рж╣ржмрзЛ ЁЯШВ"] },
    { hour: 23, message: ["рззрззржЯрж╛... good night ржмрж▓рж╛рж░ ржЖржЧрзЗ ржмрж▓рж┐ тАФ ржХрж╛рж▓ржХрзЗ рзнржЯрж╛рзЯ ржЙржаржмрж┐ ржирж╛ ржЙржарж▓рзЗ рж▓рж╛ржерж┐ ржЦрж╛ржмрж┐ ржоржирзЗ рж░рж╛ржЦрж┐рж╕ ЁЯШ┤ЁЯСК"] }
];

// Global flag
let autoSendEnabled = false;

module.exports.onLoad = function ({ api }) {
    setInterval(() => {
        if (!autoSendEnabled) return;

        const now = new Date(Date.now() + 21600000); // +6 hours for Bangladesh
        const currentHour = now.getHours();           // 0 to 23

        const match = messages.find(m => m.hour === currentHour);
        if (!match) return;

        const randomMsg = match.message[Math.floor(Math.random() * match.message.length)];

        global.data.allThreadID.forEach(threadID => {
            api.sendMessage(randomMsg, threadID, (err) => {
                if (err) console.log("Failed тЖТ", threadID);
            });
        });

    }, 60000); // ржПржЦржи ржкрзНрж░рждрж┐ ржорж┐ржирж┐ржЯрзЗ ржЪрзЗржХ ржХрж░ржмрзЗ (ржЖржЧрзЗрж░ 1s ржПрж░ ржЪрзЗрзЯрзЗ server friendly)
};

module.exports.run = async function ({ api, event, args }) {
    const { threadID, messageID } = event;
    const cmd = (args[0] || '').toLowerCase();

    if (!["on", "off", "status"].includes(cmd)) {
        return api.sendMessage(
            "ржХржорж╛ржирзНржб:\n" +
            "autosent on   тЖТ ржЪрж╛рж▓рзБ ржХрж░ржмрж┐\n" +
            "autosent off  тЖТ ржмржирзНржз ржХрж░ржмрж┐\n" +
            "autosent status тЖТ ржжрзЗржЦржмрж┐ ржЪрж▓ржЫрзЗ ржХрж┐ ржирж╛",
            threadID, messageID
        );
    }

    if (cmd === "on") {
        if (autoSendEnabled) return api.sendMessage("ржЖрж░рзЗ ржЖржЧрзЗржЗ рждрзЛ ржЪрж╛рж▓рзБ ржЖржЫрзЗ ржмрзЗ! ЁЯЩД", threadID, messageID);
        autoSendEnabled = true;
        return api.sendMessage("ЁЯФе Auto-sent ржЪрж╛рж▓рзБ рж╣рзЯрзЗ ржЧрзЗржЫрзЗ! ржПржЦржи рзирзк ржШржгрзНржЯрж╛ ржоржЬрж╛ ржЪрж▓ржмрзЗ ЁЯШИ", threadID, messageID);
    }

    if (cmd === "off") {
        if (!autoSendEnabled) return api.sendMessage("ржЖржЧрзЗржЗ ржмржирзНржз ржЖржЫрзЗ рж░рзЗ...", threadID, messageID);
        autoSendEnabled = false;
        return api.sendMessage("ЁЯЫС Auto-sent ржмржирзНржз ржХрж░рзЗ ржжрж┐рж▓рж╛ржоред ржПржЦржи рж╢рж╛ржирзНрждрж┐ ЁЯШМ", threadID, messageID);
    }

    if (cmd === "status") {
        return api.sendMessage(`Status: ${autoSendEnabled ? "ржЪрж╛рж▓рзБ ЁЯФе" : "ржмржирзНржз ЁЯШ┤"}`, threadID, messageID);
    }
};